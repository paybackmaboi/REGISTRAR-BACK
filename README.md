# Registrar Backend

A Node.js/Express backend for a registrar management system with MySQL database integration.

## Features

- User authentication and authorization
- Student record management
- Document upload and management
- Request processing system
- Role-based access control (Student, Admin, Accounting)

## Tech Stack

- **Backend**: Node.js, Express.js, TypeScript
- **Database**: MySQL with Sequelize ORM
- **Authentication**: JWT (JSON Web Tokens)
- **File Upload**: Multer
- **Deployment**: Render

## Database Configuration

The application is configured to use the following database:
- **Host**: 153.92.15.31
- **Database**: u875409848_estorco
- **User**: u875409848_estorco

## Deployment on Render

### Automatic Deployment (Recommended)

1. Fork or push this repository to GitHub
2. Go to [Render Dashboard](https://dashboard.render.com/)
3. Click "New +" and select "Web Service"
4. Connect your GitHub repository
5. Configure the service:
   - **Name**: registrar-backend
   - **Environment**: Node
   - **Build Command**: `npm install && npm run build`
   - **Start Command**: `npm start`
   - **Plan**: Free

### Environment Variables

The following environment variables are automatically configured in the `render.yaml` file:

- `NODE_ENV`: production
- `DB_HOST`: 153.92.15.31
- `DB_USER`: u875409848_estorco
- `DB_PASSWORD`: Y9Lq>$f$Q1
- `DB_NAME`: u875409848_estorco
- `DB_DIALECT`: mysql
- `JWT_SECRET`: (auto-generated by Render)
- `PORT`: 10000

### Manual Environment Variable Setup

If you prefer to set environment variables manually in Render:

1. Go to your service dashboard in Render
2. Navigate to "Environment" tab
3. Add the following environment variables:
   ```
   NODE_ENV=production
   DB_HOST=153.92.15.31
   DB_USER=u875409848_estorco
   DB_PASSWORD=Y9Lq>$f$Q1
   DB_NAME=u875409848_estorco
   DB_DIALECT=mysql
   JWT_SECRET=your-secure-jwt-secret
   PORT=10000
   ```

## API Endpoints

### Authentication
- `POST /api/auth/login` - User login
- `POST /api/auth/register` - User registration

### Students
- `GET /api/students` - Get all students
- `GET /api/students/:id` - Get student by ID
- `POST /api/students` - Create new student
- `PUT /api/students/:id` - Update student
- `DELETE /api/students/:id` - Delete student

### Requests
- `GET /api/requests` - Get all requests
- `GET /api/requests/:id` - Get request by ID
- `POST /api/requests` - Create new request
- `PUT /api/requests/:id` - Update request
- `DELETE /api/requests/:id` - Delete request

### File Upload
- `POST /api/requests/upload` - Upload documents

## Default Accounts

The system creates the following default accounts on first run:

- **Student**: ID: S001, Password: password
- **Admin**: ID: A001, Password: adminpass
- **Accounting**: ID: AC001, Password: accountingpass

## Local Development

1. Clone the repository
2. Install dependencies: `npm install`
3. Create a `.env` file with your database credentials
4. Run in development mode: `npm run dev`
5. Build for production: `npm run build`

## Database Schema

The application uses Sequelize ORM with the following models:
- **User**: Stores user information and authentication data
- **Request**: Stores document requests and their status

## Security Features

- JWT-based authentication
- Password hashing with bcrypt
- CORS enabled
- Input validation and sanitization
- File upload security measures

## Support

For issues or questions, please check the logs in your Render dashboard or contact the development team. 